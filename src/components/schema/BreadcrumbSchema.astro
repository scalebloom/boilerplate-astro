---
/**
 * BreadcrumbList Schema Component
 * Generates breadcrumb navigation for search results
 * https://schema.org/BreadcrumbList
 */

import { siteConfig } from "../../config/site.ts";

interface Props {
  currentPath: string;
}

const { currentPath } = Astro.props;

// Map of paths to page names (add custom overrides here)
const pageNames: Record<string, string> = {
  "/": "Home",
};

// Get the current page name, fallback to formatted path with title case
const getCurrentPageName = (path: string): string => {
  const normalizedPath = path === "/" ? path : path.replace(/\/$/, "");
  if (pageNames[normalizedPath]) return pageNames[normalizedPath];
  // Convert path to title case: /my-page -> My Page
  return normalizedPath
    .slice(1)
    .replace(/-/g, " ")
    .replace(/\b\w/g, (c) => c.toUpperCase());
};

// Build breadcrumb items
const breadcrumbItems = [];

// Always include Home as first item
breadcrumbItems.push({
  "@type": "ListItem",
  position: 1,
  name: "Home",
  item: siteConfig.url,
});

// Add current page if not home
if (currentPath !== "/") {
  const normalizedPath = currentPath.replace(/\/$/, "");
  breadcrumbItems.push({
    "@type": "ListItem",
    position: 2,
    name: getCurrentPageName(currentPath),
    item: `${siteConfig.url}${normalizedPath}`,
  });
}

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  itemListElement: breadcrumbItems,
};
---

<script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
